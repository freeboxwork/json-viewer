<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON Minify Online - Compress & Minify JSON</title>
    <meta name="description" content="Free online JSON minifier. Compress JSON by removing whitespace, newlines, and indentation. See size reduction percentage.">
    <meta name="google-adsense-account" content="ca-pub-8753276846370247">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8753276846370247" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <script src="app.js"></script>
    <script>document.write(getNavHTML('minify'));</script>

    <main>
        <div class="page-header">
            <h1>JSON Minify / Compress</h1>
            <p>Remove all whitespace from JSON to reduce file size</p>
        </div>

        <div class="toolbar">
            <button class="btn btn-primary" onclick="minifyJSON()">&#128220; Minify</button>
            <button class="btn btn-secondary" onclick="beautifyJSON()">&#9998; Beautify</button>
            <div class="toolbar-separator"></div>
            <button class="btn btn-secondary btn-sm" onclick="triggerUpload('jsonInput', minifyJSON)">&#128194; Upload</button>
            <button class="btn btn-secondary btn-sm" onclick="copyMinified()">&#128203; Copy</button>
            <button class="btn btn-secondary btn-sm" onclick="downloadMinified()">&#11015; Download</button>
            <button class="btn btn-danger btn-sm" onclick="clearMinify()">&#128465; Clear</button>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="input" onclick="switchTab('input')">Input</button>
            <button class="tab" data-tab="output" onclick="switchTab('output')">Minified Output</button>
        </div>

        <div class="tab-body">
            <div class="tab-panel active" id="panel-input">
                <textarea class="editor-area" id="jsonInput" placeholder="Paste your JSON here to minify..." spellcheck="false"></textarea>
            </div>
            <div class="tab-panel" id="panel-output">
                <textarea class="editor-area" id="jsonOutput" placeholder="Minified JSON will appear here..." spellcheck="false" readonly style="cursor:default;"></textarea>
            </div>
        </div>

        <div class="status-bar" id="sizeBar" style="display:none;">
            <div class="status-item"><span style="font-weight:700;color:var(--text-secondary);">Original:</span> <span id="origSize">-</span></div>
            <div class="status-item"><span style="font-weight:700;color:var(--text-secondary);">Minified:</span> <span id="minSize">-</span></div>
            <div class="status-item"><span style="font-weight:700;color:var(--success);">Saved:</span> <span id="savedSize" style="color:var(--success);font-weight:700;">-</span></div>
        </div>

        <div class="status-bar">
            <div class="status-item"><div class="status-dot neutral" id="statusDot"></div><span id="statusText">Ready</span></div>
        </div>
    </main>

    <script>document.write(getFooterHTML());</script>

    <script>
        const input = document.getElementById('jsonInput');
        const output = document.getElementById('jsonOutput');
        let minifiedText = '';

        setupTextareaDrop('jsonInput', minifyJSON);

        function minifyJSON() {
            const text = input.value.trim();
            if (!text) { setStatus('Please enter JSON', 'invalid'); return; }
            const result = parseJSON(text);
            if (!result.success) { setStatus(`Error: ${result.error.message}`, 'invalid'); output.value = ''; return; }
            minifiedText = JSON.stringify(result.data);
            output.value = minifiedText;
            const origBytes = new Blob([text]).size;
            const minBytes = new Blob([minifiedText]).size;
            const saved = origBytes - minBytes;
            const percent = origBytes > 0 ? ((saved / origBytes) * 100).toFixed(1) : 0;
            document.getElementById('sizeBar').style.display = '';
            document.getElementById('origSize').textContent = formatBytes(origBytes);
            document.getElementById('minSize').textContent = formatBytes(minBytes);
            document.getElementById('savedSize').textContent = `${formatBytes(saved)} (${percent}%)`;
            setStatus(`Minified \u2014 ${percent}% reduction`, 'valid');
            switchTab('output');
        }

        function beautifyJSON() {
            const text = input.value.trim();
            if (!text) return;
            const result = parseJSON(text);
            if (!result.success) { setStatus(`Error: ${result.error.message}`, 'invalid'); return; }
            input.value = JSON.stringify(result.data, null, 2);
            document.getElementById('sizeBar').style.display = 'none';
            setStatus('Beautified', 'valid');
        }

        function copyMinified() { if (!minifiedText) { showToast('Nothing to copy', 'error'); return; } copyToClipboard(minifiedText); }
        function downloadMinified() { if (!minifiedText) { showToast('Nothing to download', 'error'); return; } downloadFile(minifiedText, 'minified.json'); }
        function clearMinify() { input.value = ''; output.value = ''; minifiedText = ''; document.getElementById('sizeBar').style.display = 'none'; setStatus('Ready', 'neutral'); switchTab('input'); }
        function setStatus(text, type) { document.getElementById('statusText').textContent = text; document.getElementById('statusDot').className = 'status-dot ' + type; }
    </script>
</body>
</html>
