<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RBD0W9Q8JX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-RBD0W9Q8JX');
    </script>
    <!-- Microsoft Clarity -->
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "vdqmmmdmnt");
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON to CSV Converter Online - Free JSON to CSV Tool</title>
    <meta name="description" content="Convert JSON arrays to CSV format online for free. Preview as table, choose delimiters, and download CSV files instantly.">
    <link rel="canonical" href="https://json-viewer-ce3.pages.dev/json-to-csv.html">
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    <link rel="icon" href="icon.png" type="image/png" sizes="192x192">
    <link rel="apple-touch-icon" href="icon.png">
    <meta property="og:title" content="JSON to CSV Converter Online - Free JSON to CSV Tool">
    <meta property="og:description" content="Convert JSON arrays to CSV format online for free. Preview as table and download CSV files.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://json-viewer-ce3.pages.dev/json-to-csv.html">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="JSON to CSV Converter Online">
    <meta name="twitter:description" content="Convert JSON arrays to CSV format online for free. Preview as table and download CSV files.">
    <meta name="robots" content="index, follow">
    <meta property="og:site_name" content="JSON Tools">
    <meta property="og:locale" content="en_US">
    <meta property="og:image" content="https://json-viewer-ce3.pages.dev/favicon.svg">
    <link rel="alternate" type="application/rss+xml" title="JSON Tools RSS" href="https://json-viewer-ce3.pages.dev/rss.xml">
    <meta name="google-adsense-account" content="ca-pub-8753276846370247">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8753276846370247" crossorigin="anonymous"></script>
    <script type="application/ld+json">
    [{"@context":"https://schema.org","@type":"WebApplication","name":"JSON to CSV Converter","url":"https://json-viewer-ce3.pages.dev/json-to-csv.html","description":"Free online JSON to CSV converter. Convert JSON arrays and nested objects to CSV format.","applicationCategory":"DeveloperApplication","operatingSystem":"Any","offers":{"@type":"Offer","price":"0","priceCurrency":"USD"},"isPartOf":{"@type":"WebSite","name":"JSON Tools","url":"https://json-viewer-ce3.pages.dev"}},{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"JSON Tools","item":"https://json-viewer-ce3.pages.dev"},{"@type":"ListItem","position":2,"name":"JSON to CSV","item":"https://json-viewer-ce3.pages.dev/json-to-csv.html"}]}]
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="preload" href="style.css" as="style">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js" defer></script>
</head>
<body data-page="to-csv">
    <nav id="site-nav"></nav>

    <main>
        <div class="page-header">
            <h1>JSON to CSV Converter</h1>
            <p>Convert JSON arrays to CSV format with table preview and download</p>
        </div>

        <div class="toolbar">
            <button class="btn btn-primary" onclick="convertToCSV()">&#128260; Convert to CSV</button>
            <div class="toolbar-separator"></div>
            <div class="option-group"><label>Delimiter:</label>
                <select class="select" id="delimiter"><option value="," selected>Comma</option><option value="&#9;">Tab</option><option value=";">Semicolon</option></select>
            </div>
            <label style="display:flex;align-items:center;gap:6px;cursor:pointer;"><input type="checkbox" id="includeHeader" checked style="accent-color:var(--accent);"><span style="font-size:0.82rem;color:var(--text-secondary);">Header</span></label>
            <div class="toolbar-separator"></div>
            <button class="btn btn-secondary btn-sm" onclick="triggerUpload('jsonInput', convertToCSV)">&#128194; Upload</button>
            <button class="btn btn-secondary btn-sm" onclick="loadSampleCSV()">Sample</button>
            <button class="btn btn-secondary btn-sm" onclick="copyCSV()">&#128203; Copy</button>
            <button class="btn btn-secondary btn-sm" onclick="downloadCSV()">&#11015; Download</button>
            <button class="btn btn-danger btn-sm" onclick="clearCSV()">&#128465; Clear</button>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="input" onclick="switchTab('input')">JSON Input</button>
            <button class="tab" data-tab="output" onclick="switchTab('output')">CSV Output</button>
            <button class="tab" data-tab="table" onclick="switchTab('table')">Table Preview</button>
        </div>

        <div class="tab-body">
            <div class="tab-panel active" id="panel-input">
                <textarea class="editor-area" id="jsonInput" placeholder='Paste a JSON array here...' spellcheck="false"></textarea>
            </div>
            <div class="tab-panel" id="panel-output">
                <textarea class="editor-area" id="csvOutput" placeholder="CSV output..." readonly style="cursor:default;"></textarea>
            </div>
            <div class="tab-panel" id="panel-table">
                <div style="overflow-x:auto;padding:14px;"><table class="data-table" id="previewTable"></table></div>
            </div>
        </div>

        <div class="status-bar"><div class="status-item"><div class="status-dot neutral" id="statusDot"></div><span id="statusText">Ready</span></div></div>
    </main>

    <!-- Educational Content -->
    <section class="guide-section">
        <h2>What is JSON to CSV Conversion?</h2>
        <p>JSON to CSV conversion transforms structured JSON data into a flat, tabular CSV (Comma-Separated Values) format. While JSON excels at representing hierarchical and nested data structures, CSV is the universal format for spreadsheet applications like Microsoft Excel, Google Sheets, and database import tools.</p>
        <p>This tool automatically detects arrays of objects within your JSON data and converts them into CSV rows, with object keys becoming column headers.</p>

        <h2>How to Use This Tool</h2>
        <ol class="guide-steps">
            <li>Paste your JSON data into the input area, or upload a <code>.json</code> file.</li>
            <li>Click <strong>Convert to CSV</strong>. If your JSON contains multiple arrays, use the <strong>Source</strong> dropdown to select which array to convert.</li>
            <li>Preview the result in the table view to verify the conversion.</li>
            <li>Click <strong>Copy</strong> to copy the CSV text, or <strong>Download</strong> to save it as a <code>.csv</code> file.</li>
        </ol>

        <h2>JSON vs CSV: When to Use Which?</h2>
        <div class="guide-card">
            <ul>
                <li><strong>JSON</strong> — Best for APIs, configuration files, and data with nested or hierarchical structures. Supports objects, arrays, and multiple data types.</li>
                <li><strong>CSV</strong> — Best for flat, tabular data. Ideal for spreadsheets, data analysis, database imports, and simple data exchange.</li>
                <li><strong>Convert JSON to CSV when</strong> — You need to import data into Excel/Google Sheets, perform data analysis, or share data with non-technical users.</li>
            </ul>
        </div>

        <h2>Frequently Asked Questions</h2>
        <details class="faq-item">
            <summary>What happens to nested JSON objects during conversion?</summary>
            <div class="faq-answer">Nested objects are flattened using dot notation for column headers. For example, <code>{"address":{"city":"Seoul"}}</code> becomes a column named <code>address.city</code> with the value <code>Seoul</code>. Arrays within objects are serialized as JSON strings in the CSV cell.</div>
        </details>
        <details class="faq-item">
            <summary>Can I convert JSON with multiple arrays?</summary>
            <div class="faq-answer">Yes. The tool automatically detects all arrays of objects in your JSON and presents them in a dropdown selector. You can choose which array to convert to CSV. If no arrays are found, the root object is flattened into a single CSV row.</div>
        </details>
    </section>

    <div id="site-footer"></div>

    <script src="app.js"></script>
    <script>
        let csvText = '';
        setupTextareaDrop('jsonInput', convertToCSV);

        function convertToCSV() {
            const text = document.getElementById('jsonInput').value.trim();
            if (!text) { setStatus('Please enter JSON', 'invalid'); return; }
            const result = parseJSON(text);
            if (!result.success) { setStatus(`Error: ${result.error.message}`, 'invalid'); return; }
            let data = result.data;
            let statusMsg = '';
            if (!Array.isArray(data)) {
                // Find all arrays of objects in the data (top-level keys)
                const arrayEntries = [];
                function findArrays(obj, path) {
                    if (!obj || typeof obj !== 'object' || Array.isArray(obj)) return;
                    for (const [key, value] of Object.entries(obj)) {
                        const p = path ? path + '.' + key : key;
                        if (Array.isArray(value) && value.length > 0 && typeof value[0] === 'object' && value[0] !== null) {
                            arrayEntries.push({ path: p, data: value, count: value.length });
                        } else if (value && typeof value === 'object' && !Array.isArray(value)) {
                            findArrays(value, p);
                        }
                    }
                }
                findArrays(data, '');

                if (arrayEntries.length > 0) {
                    // Build array selector if not already present
                    buildArraySelector(arrayEntries);
                    // Use selected array or the largest one by default
                    const selectedPath = document.getElementById('arraySelect')?.value;
                    const selected = arrayEntries.find(a => a.path === selectedPath) || arrayEntries.sort((a, b) => b.count - a.count)[0];
                    data = selected.data;
                    statusMsg = `"${selected.path}" array (${selected.count} items)`;
                } else {
                    // No arrays found - flatten entire object as a single row
                    data = [data];
                    statusMsg = 'Flattened root object as 1 row';
                }
            } else {
                statusMsg = `${data.length} items`;
            }
            if (data.length === 0) { setStatus('Empty array', 'invalid'); return; }
            const flattened = data.map(item => flattenObject(item));
            csvText = Papa.unparse(flattened, { delimiter: document.getElementById('delimiter').value, header: document.getElementById('includeHeader').checked });
            document.getElementById('csvOutput').value = csvText;
            renderTable(flattened);
            setStatus(`Converted ${flattened.length} rows from ${statusMsg}`, 'valid');
            switchTab('output');
        }

        function buildArraySelector(entries) {
            let container = document.getElementById('arraySelectorContainer');
            if (!container) {
                container = document.createElement('div');
                container.id = 'arraySelectorContainer';
                container.className = 'option-group';
                container.style.cssText = 'margin-left:8px;';
                container.innerHTML = '<label style="font-size:0.82rem;color:var(--text-secondary);font-weight:600;">Source:</label>';
                const select = document.createElement('select');
                select.id = 'arraySelect';
                select.className = 'select';
                select.onchange = convertToCSV;
                container.appendChild(select);
                // Insert after the first toolbar separator
                const toolbar = document.querySelector('.toolbar');
                const firstSep = toolbar.querySelectorAll('.toolbar-separator')[1];
                if (firstSep) toolbar.insertBefore(container, firstSep);
                else toolbar.appendChild(container);
            }
            const select = document.getElementById('arraySelect');
            const currentVal = select.value;
            select.innerHTML = entries.map(e => `<option value="${e.path}" ${e.path === currentVal ? 'selected' : ''}>${e.path} (${e.count} items)</option>`).join('');
        }

        function flattenObject(obj, prefix = '') {
            const result = {};
            for (const [key, value] of Object.entries(obj)) {
                const newKey = prefix ? `${prefix}.${key}` : key;
                if (value !== null && typeof value === 'object' && !Array.isArray(value)) Object.assign(result, flattenObject(value, newKey));
                else if (Array.isArray(value)) result[newKey] = JSON.stringify(value);
                else result[newKey] = value;
            }
            return result;
        }

        function renderTable(data) {
            if (data.length === 0) return;
            const headers = Object.keys(data[0]);
            const maxRows = Math.min(data.length, 100);
            let html = '<thead><tr>' + headers.map(h => `<th>${h}</th>`).join('') + '</tr></thead><tbody>';
            for (let i = 0; i < maxRows; i++) {
                html += '<tr>' + headers.map(h => `<td>${data[i][h] == null ? '' : String(data[i][h]).replace(/</g, '&lt;')}</td>`).join('') + '</tr>';
            }
            document.getElementById('previewTable').innerHTML = html + '</tbody>';
        }

        function loadSampleCSV() {
            document.getElementById('jsonInput').value = JSON.stringify([
                {id:1,name:"Alice",age:28,city:"Seoul",active:true},{id:2,name:"Bob",age:35,city:"Busan",active:false},
                {id:3,name:"Charlie",age:22,city:"Incheon",active:true},{id:4,name:"Diana",age:31,city:"Daegu",active:true}
            ], null, 2);
            convertToCSV();
        }

        function copyCSV() { if (!csvText) { showToast('Nothing to copy', 'error'); return; } copyToClipboard(csvText); }
        function downloadCSV() { if (!csvText) { showToast('Nothing to download', 'error'); return; } downloadFile(csvText, 'data.csv', 'text/csv'); }
        function clearCSV() { document.getElementById('jsonInput').value = ''; document.getElementById('csvOutput').value = ''; csvText = ''; document.getElementById('previewTable').innerHTML = ''; setStatus('Ready', 'neutral'); switchTab('input'); }
        function setStatus(t, type) { document.getElementById('statusText').textContent = t; document.getElementById('statusDot').className = 'status-dot ' + type; }
    </script>
</body>
</html>
